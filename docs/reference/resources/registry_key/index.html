<!DOCTYPE html><html><head><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport" /><link href="/favicon.png" rel="icon" type="image/png" /><link href="/favicon.ico" rel="icon" /><title>About the registry_key Resource</title><link href="css/inspec_tutorial.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/site.css" rel="stylesheet" /></head><body class="docs docs_reference docs_reference_resources docs_reference_resources_registry_key docs_reference_resources_registry_key_index"><script>gm_session_id = 'inspecGlobalMessage8';</script><div class="container"><nav id="main-nav"><progress value="0"></progress><div id="main-nav-ctas"><a class="main-nav--logo" href="/"><img onerror="this.src='/images/inspec-by-chef-logo.png'" src="/images/inspec-by-chef-logo.svg" /></a><i class="fa fa-bars main-nav--toggle strict-right mobile-show"></i><ul class="main-nav--links"><li class="main-nav--link"><a href="/tutorials" class="" <span class="main-nav--link-text">Tutorials</span></a></li><li class="main-nav--link"><a href="/docs" class="" <span class="main-nav--link-text">Docs</span></a></li><li class="main-nav--link"><a href="/community" class="" <span class="main-nav--link-text">Community</span></a></li><li class="main-nav--link"><a href="https://github.com/chef/inspec"><i class="fa fa-github-alt"></i><span class="main-nav--link-text">Github</span></a></li><li class="main-nav--link nav-cta hide-for-small-only"><a class="btn try-demo" href="/tutorial">Try the Demo</a></li><li class="main-nav--link nav-cta"><a class="btn" href="/downloads"><i class="fa fa-cloud-download"></i><span class="main-nav--link-text">Download</span></a></li></ul></div></nav><main id="main-content"><!--animated banner--><header class="child-h blue-gradient margin-top-offset"><div id="particles-second"><canvas class="particles-js-canvas-el" /></div><div class="purp-shade"><div class="row relative-top searchbar"><div class="column columns"><form action="/docs/search/" class="main-sidebar--search" method="get"><input class="st-default-search-input" name="q" placeholder="Search Documentation" type="text" /><button action="/docs/search/" class="search shadow" method="get"><img src="/images/community/search.svg" /></button></form></div></div></div></header><div class="row margin-both"><column class="columns large-3 medium-3" id="sidebar"><ul class="main-sidebar--links"><li class="main-sidebar--link"><small>Getting Started</small><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item--a"><a href="/docs">Overview</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="https://downloads.chef.io/inspec">Get InSpec</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/tutorials">Tutorials</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/inspec_and_friends">InSpec and friends</a><i class="focus strict-right">&GreaterGreater; </i></li></ul></li><li class="main-sidebar--link"><small>Reference</small><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item--a"><a href="/docs/reference/cli">inspec executable</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/profiles">Profiles</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/resources">Resources</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/matchers">Matchers</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/dsl_inspec">InSpec DSL</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/dsl_resource">Resource DSL</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/plugin_kitchen_inspec">kitchen-inspec</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/shell">inspec shell</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/habitat">Habitat Integration</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/ruby_usage">Ruby usage</a><i class="focus strict-right">&GreaterGreater; </i></li><li class="main-sidebar--list--item--a"><a href="/docs/reference/migration">Migration from Serverspec</a><i class="focus strict-right">&GreaterGreater; </i></li></ul></li></ul></column><column class="columns large-9 medium-9"><h1 id="registry_key">registry_key</h1>

<p>Use the <code>registry_key</code> InSpec audit resource to test key values in the Windows registry.</p>

<p><br></p>

<h2 id="syntax">Syntax</h2>

<p>A <code>registry_key</code> resource block declares the item in the Windows registry, the path to a setting under that item, and then one (or more) name/value pairs to be tested.</p>

<p>Use a registry key name and path:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key('Task Scheduler','HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Schedule') do
  its('Start') { should eq 2 }
end
</code></pre></div>
<p>Use only a registry key path:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key('Task Scheduler','HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Schedule') do
  its('Start') { should eq 2 }
end
</code></pre></div>
<p>Or use a Ruby Hash:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key({
  name: 'Task Scheduler',
  hive: 'HKEY_LOCAL_MACHINE',
  key: '\SYSTEM\CurrentControlSet\services\Schedule'
}) do
  its('Start') { should eq 2 }
end
</code></pre></div>
<h3 id="registry-key-path-separators">Registry Key Path Separators</h3>

<p>A Windows registry key can be used as a string in Ruby code, such as when a registry key is used as the name of a recipe. In Ruby, when a registry key is enclosed in a double-quoted string (<code>&quot; &quot;</code>), the same backslash character (<code>\</code>) that is used to define the registry key path separator is also used in Ruby to define an escape character. Therefore, the registry key path separators must be escaped when they are enclosed in a double-quoted string. For example, the following registry key:</p>
<div class="highlight"><pre class="highlight plaintext"><code>HKCU\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Themes
</code></pre></div>
<p>may be encloused in a single-quoted string with a single backslash:</p>
<div class="highlight"><pre class="highlight plaintext"><code>'HKCU\SOFTWARE\path\to\key\Themes'
</code></pre></div>
<p>or may be enclosed in a double-quoted string with an extra backslash as an escape character:</p>
<div class="highlight"><pre class="highlight plaintext"><code>"HKCU\\SOFTWARE\\path\\to\\key\\Themes"
</code></pre></div>
<p class="warning">
Please make sure that you use backslashes instead of forward slashes. Forward slashes will not work for registry keys.
</p>
<div class="highlight"><pre class="highlight plaintext"><code># The following will not work:
# describe registry_key('HKLM/SOFTWARE/Microsoft/NET Framework Setup/NDP/v4/Full/1033') do
#   its('Release') { should eq 378675 }
# end
# You should use:
describe registry_key('HKLM\SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full\1033') do
  its('Release') { should eq 378675 }
end
</code></pre></div>
<p><br></p>

<h2 id="examples">Examples</h2>

<p>The following examples show how to use this InSpec audit resource.</p>

<h3 id="test-the-start-time-for-the-schedule-service">Test the start time for the Schedule service</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key('Task Scheduler','HKEY_LOCAL_MACHINE\...\Schedule') do
  its('Start') { should eq 2 }
end
</code></pre></div>
<p>where <code>&#39;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\Schedule&#39;</code> is the full path to the setting.</p>

<h3 id="use-a-regular-expression-in-responses">Use a regular expression in responses</h3>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key({
  hive: 'HKEY_LOCAL_MACHINE',
  key: 'SOFTWARE\Microsoft\Windows NT\CurrentVersion'
}) do
  its('ProductName') { should match /^[a-zA-Z0-9\(\)\s]*2012\s[rR]2[a-zA-Z0-9\(\)\s]*$/ }
end
</code></pre></div>
<p><br></p>

<h2 id="matchers">Matchers</h2>

<p>This InSpec audit resource has the following matchers. For a full list of available matchers please visit our <a href="https://www.inspec.io/docs/reference/matchers/">matchers page</a>.</p>

<h3 id="children">children</h3>

<p>The <code>children</code> matcher return all of the child items of a registry key. A regular expression may be used to filter child items:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key('Key Name', '\path\to\key').children(regex)
  ...
end
</code></pre></div>
<p>For example, to get all child items for a registry key:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key('Task Scheduler','HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet').children do
  it { should_not eq [] }
end
</code></pre></div>
<p>The following example shows how find a property that may exist against multiple registry keys, and then test that property for every registry key in which that property is located:</p>
<div class="highlight"><pre class="highlight plaintext"><code>describe registry_key({
  hive: 'HKEY_USERS'
}).children(/^S-1-5-21-[0-9]+-[0-9]+-[0-9]+-[0-9]{3,}\\Software\\Policies\\Microsoft\\Windows\\Installer/).each { |key|
    describe registry_key(key) do
      its('AlwaysInstallElevated') { should eq 'value' }
    end
  }
</code></pre></div>
<h3 id="exist">exist</h3>

<p>The <code>exist</code> matcher tests if the registry key is present:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should exist }
</code></pre></div>
<h3 id="have_property">have_property</h3>

<p>The <code>have_property</code> matcher tests if a property exists for a registry key:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should have_property 'value' }
</code></pre></div>
<h3 id="have_property_value">have_property_value</h3>

<p>The <code>have_property_value</code> matcher tests if a property value exists for a registry key:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should have_property_value 'value' }
</code></pre></div>
<h3 id="have_value">have_value</h3>

<p>The <code>have_value</code> matcher tests if a value exists for a registry key:</p>
<div class="highlight"><pre class="highlight plaintext"><code>it { should have_value 'value' }
</code></pre></div>
<h3 id="name">name</h3>

<p>The <code>name</code> matcher tests the value for the specified registry setting:</p>
<div class="highlight"><pre class="highlight plaintext"><code>its('name') { should eq 'value' }
</code></pre></div>
<p class="warning">
Any name with a dot will not work as expected: <code>its('explorer.exe') { should eq 'test' }</code>. This issue is tracked in <a href="https://github.com/chef/inspec/issues/1281">https://github.com/chef/inspec/issues/1281</a>
</p>
<div class="highlight"><pre class="highlight plaintext"><code># instead of:
# its('explorer.exe') { should eq 'test' }
# use the following solution:
it { should have_property_value('explorer.exe', :string, 'test') }
</code></pre></div></column></div><script>// Swiftype JS code snippet
(function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
(w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
})(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

_st('install','xzyJV6P7pgscygGyyTm8','2.0.0');
// end Swiftype code snippet

document.getElementsByClassName("st-default-search-input")[0].focus();</script></main></div><footer class="dark-bg" id="main-footer"><div class="strict-center" id="dlmsg"><img id="hex" src="/images/hexagon.svg" /><h3 class="t-white margin-top-xs txt-margin">See how it works in less than 10 minutes!</h3><div class="row margin-top-xs"><a class="btn t-white try-demo hide-for-small-only" href="/tutorial">Try the Demo</a><a class="btn t-white" href="https://downloads.chef.io/inspec"><i class="fa fa-cloud-download"></i><span>Download</span></a></div></div><div class="columns large-4 medium-4 mobile-hide"><ul class="footer--logos"><li><a class="footer--logo inspec" href="/"><img src="/images/inspec-by-chef-logo.png" /></a></li><li><a class="footer--logo chef" href="http://www.chef.io"><img src="/images/chef-logo.png" /></a></li></ul></div><div class="columns large-8 medium-8"><ul class="footer--links strict-right"><li><a class="footer--link" href="/legal/licensing">Licensing</a></li><li><a class="footer--link" href="/legal/terms-and-conditions">Terms &amp; Conditions</a></li><li><a class="footer--link" href="/legal/trademark-policy">Trademark Policy</a></li><li><a class="footer--link" href="/legal/privacy-policy">Privacy Policy</a></li></ul><div class="columns margin-both-xs mobile-show"><ul class="footer--logos"><li><a class="footer--logo inspec" href="/"><img src="/images/inspec-by-chef-logo.png" /></a></li><li><a class="footer--logo chef" href="http://www.chef.io"><img src="/images/chef-logo.png" /></a></li></ul></div></div><p class="strict-center clear"><small>&copy; Chef Software 2017</small></p></footer><script src="https://s3.amazonaws.com/menumaker/menumaker.min.js"></script><script src="scripts/inspec_tutorial.js"></script><script src="dist/inspec_tutorial.js"></script><div class="inspec-tutorial" hidden="true" inspec-tutorial="true">Loading</div><script src="/javascripts/all.js"></script><script>//initiate sticky sidebar from jquery.sticky.js

 if (window.innerWidth > 640) { //don't fix on mobile
   $('#sidebar').stick_in_parent();
 }</script><script>//Parallax Text

if (window.innerWidth > 900) { //don't parallax on tablet/mobile
$(window).enllax(); //initiate parallax on larger screens
}</script><script>//Code pop-up animation on homepage

$('.code-trigger').click(function() {
  $(this).toggleClass('turn-angle');
  $('.code-pop').slideToggle(500);
});</script><script>//Animate HR on scroll

$(window).scroll(function() {

var scroll = $(window).scrollTop();
var objectSelect = $('#icon-trigger'); //parent that triggers scroll
var objectPosition = objectSelect.offset().top;
if (scroll > objectPosition) {
$('hr.first').addClass('stretch')  //add class animate class to HR

}
});</script><script>//Animating progress bar for header

$(document).ready(function(){

var getMax = function(){
    return $(document).height() - $(window).height();
}

var getValue = function(){
    return $(window).scrollTop();
}

if('max' in document.createElement('progress')){
    // Browser supports progress element
    var progressBar = $('progress');

    // Set the Max attr for the first time
    progressBar.attr({ max: getMax() });

    $(document).on('scroll', function(){
        // On scroll only Value attr needs to be calculated
        progressBar.attr({ value: getValue() });
    });

    $(window).resize(function(){
        // On resize, both Max/Value attr needs to be calculated
        progressBar.attr({ max: getMax(), value: getValue() });
    });
}
else {
    var progressBar = $('.progress-bar'),
        max = getMax(),
        value, width;

    var getWidth = function(){
        // Calculate width in percentage
        value = getValue();
        width = (value/max) * 100;
        width = width + '%';
        return width;
    }

    var setWidth = function(){
        progressBar.css({ width: getWidth() });
    }

    $(document).on('scroll', setWidth);
    $(window).on('resize', function(){
        // Need to reset the Max attr
        max = getMax();
        setWidth();
    });
    }
  });</script><script>$(document).foundation();
$('.try-demo').click(function(event){
  event.stopPropagation();
  $('.inspec-tutorial').show()
  window.dispatchEvent(new Event('resizeTerminal'));
  $('.quit-inspec-tutorial').click(function(event){
    event.stopPropagation();
    $('.inspec-tutorial').hide()
  })
});</script><script src="/javascripts/segment.js"></script></body></html>